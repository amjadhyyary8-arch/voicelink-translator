<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VoiceLink - ØªØ±Ø¬Ù…Ø© ØµÙˆØªÙŠØ© ÙÙˆØ±ÙŠØ©</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
      min-height: 100vh;
      color: white;
      direction: rtl;
    }

    .container {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      padding-top: 20px;
    }

    .logo {
      font-size: 50px;
      margin-bottom: 10px;
    }

    .title {
      font-size: 32px;
      font-weight: 700;
      background: linear-gradient(to right, #60a5fa, #c084fc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #c084fc;
      font-size: 16px;
    }

    .language-selector {
      margin-bottom: 30px;
    }

    .selector-label {
      font-size: 16px;
      color: #93c5fd;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .lang-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    @media (min-width: 400px) {
      .lang-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    .lang-btn {
      padding: 15px 5px;
      border: none;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .lang-btn.active {
      background: linear-gradient(135deg, #8b5cf6, #ec4899);
      box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4);
      border: none;
    }

    .lang-flag {
      font-size: 28px;
      margin-bottom: 5px;
    }

    .lang-name {
      font-size: 14px;
      font-weight: 600;
    }

    .mic-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 40px 0;
    }

    .mic-button {
      width: 140px;
      height: 140px;
      border: none;
      border-radius: 50%;
      background: linear-gradient(135deg, #8b5cf6, #ec4899);
      box-shadow: 0 15px 35px rgba(139, 92, 246, 0.4);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }

    .mic-button:hover {
      transform: scale(1.05);
    }

    .mic-button.listening {
      background: linear-gradient(135deg, #ef4444, #ec4899);
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .mic-icon {
      width: 60px;
      height: 60px;
      fill: white;
    }

    .mic-status {
      margin-top: 20px;
      font-size: 18px;
      color: #c084fc;
      text-align: center;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .translation-area {
      margin-top: 30px;
    }

    .result-box {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .result-lang {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 16px;
      color: #93c5fd;
    }

    .result-text {
      font-size: 22px;
      line-height: 1.6;
      color: white;
      margin-bottom: 20px;
      word-break: break-word;
      text-align: right;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
    }

    .action-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.15);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s;
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    .action-btn.speak {
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    }

    .action-btn.copy {
      background: linear-gradient(135deg, #10b981, #3b82f6);
    }

    .error-box {
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.5);
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }

    .error-text {
      color: #fecaca;
      font-size: 14px;
    }

    .footer {
      text-align: center;
      color: rgba(147, 197, 253, 0.7);
      font-size: 12px;
      margin-top: 30px;
      padding: 15px 0;
    }

    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="logo">ğŸ¤</div>
      <h1 class="title">VoiceLink</h1>
      <p class="subtitle">ØªØ­Ø¯Ø« Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŒ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªØ±Ø¬Ù…Ø© ÙÙˆØ±ÙŠØ©</p>
    </div>

    <!-- Language Selector -->
    <div class="language-selector">
      <div class="selector-label">
        <span>ğŸŒ</span>
        <span>Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¥Ù„Ù‰:</span>
      </div>
      <div class="lang-grid" id="languageGrid"></div>
    </div>

    <!-- Mic Container -->
    <div class="mic-container">
      <button class="mic-button" id="micButton">
        <svg class="mic-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
          <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
          <line x1="12" x2="12" y1="19" y2="22"/>
        </svg>
      </button>
      <div class="mic-status" id="micStatus">Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ­Ø¯Ø« Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
    </div>

    <!-- Translation Area -->
    <div class="translation-area" id="translationArea">
      <div class="result-box">
        <div class="result-text" style="text-align: center; color: #c084fc;">
          <p>ğŸ’¡ <strong>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong></p>
          <p>1. Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ© Ø§Ù„Ù‡Ø¯Ù</p>
          <p>2. Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†</p>
          <p>3. ØªØ­Ø¯Ø« Ø¨ÙˆØ¶ÙˆØ­ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
          <p>4. Ø´Ø§Ù‡Ø¯ Ø§Ù„ØªØ±Ø¬Ù…Ø© ØªØ¸Ù‡Ø±</p>
        </div>
      </div>
    </div>

    <!-- Error Box -->
    <div id="errorBox" class="error-box hidden">
      <p class="error-text" id="errorText"></p>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>âœ… ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª | âœ… Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ø¹Ø¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</p>
    </div>
  </div>

  <script>
    // Ù„ØºØ§Øª Ù…Ø¯Ø¹ÙˆÙ…Ø©
    const languages = [
      { code: 'en', name: 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', flag: 'ğŸ‡¬ğŸ‡§', voice: 'en-US' },
      { code: 'fr', name: 'Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©', flag: 'ğŸ‡«ğŸ‡·', voice: 'fr-FR' },
      { code: 'es', name: 'Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠØ©', flag: 'ğŸ‡ªğŸ‡¸', voice: 'es-ES' },
      { code: 'de', name: 'Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ©', flag: 'ğŸ‡©ğŸ‡ª', voice: 'de-DE' }
    ];

    // Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¨Ø³ÙŠØ· ÙˆØ§Ù„Ø¯Ù‚ÙŠÙ‚
    const translations = {
      // Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
      'Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…': { en: 'Peace be upon you / Hello', fr: 'Paix sur vous / Bonjour', es: 'La paz sea contigo / Hola', de: 'Friede sei mit dir / Hallo' },
      'Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…': { en: 'Peace be upon you / Hello', fr: 'Paix sur vous / Bonjour', es: 'La paz sea contigo / Hola', de: 'Friede sei mit dir / Hallo' },
      'Ù…Ø±Ø­Ø¨Ø§': { en: 'Hello', fr: 'Bonjour', es: 'Hola', de: 'Hallo' },
      'Ø£Ù‡Ù„Ø§': { en: 'Hi', fr: 'Salut', es: 'Hola', de: 'Hi' },
      'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±': { en: 'Good morning', fr: 'Bonjour', es: 'Buenos dÃ­as', de: 'Guten Morgen' },
      'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±': { en: 'Good evening', fr: 'Bonsoir', es: 'Buenas tardes', de: 'Guten Abend' },
      'ØªØµØ¨Ø­ Ø¹Ù„Ù‰ Ø®ÙŠØ±': { en: 'Good night', fr: 'Bonne nuit', es: 'Buenas noches', de: 'Gute Nacht' },
      'Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©': { en: 'Goodbye', fr: 'Au revoir', es: 'AdiÃ³s', de: 'Auf Wiedersehen' },
      'Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‚Ø§Ø¡': { en: 'See you later', fr: 'Ã€ plus tard', es: 'Hasta luego', de: 'Bis spÃ¤ter' },
      
      'ÙƒÙŠÙ Ø­Ø§Ù„Ùƒ': { en: 'How are you', fr: 'Comment allez-vous', es: 'Â¿CÃ³mo estÃ¡s?', de: 'Wie geht es dir?' },
      'Ø£Ù†Ø§ Ø¨Ø®ÙŠØ±': { en: 'I am fine', fr: 'Je vais bien', es: 'Estoy bien', de: 'Mir geht es gut' },
      'Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡': { en: 'Thank God', fr: 'Dieu merci', es: 'Gracias a Dios', de: 'Gott sei Dank' },
      
      'Ø´ÙƒØ±Ø§': { en: 'Thank you', fr: 'Merci', es: 'Gracias', de: 'Danke' },
      'Ø´ÙƒØ±Ø§ Ø¬Ø²ÙŠÙ„Ø§': { en: 'Thank you very much', fr: 'Merci beaucoup', es: 'Muchas gracias', de: 'Vielen Dank' },
      'Ù…Ù† ÙØ¶Ù„Ùƒ': { en: 'Please', fr: 'S\'il vous plaÃ®t', es: 'Por favor', de: 'Bitte' },
      'Ø¹ÙÙˆØ§': { en: 'You\'re welcome', fr: 'De rien', es: 'De nada', de: 'Bitte schÃ¶n' },
      'Ø¹Ø°Ø±Ø§Ù‹': { en: 'Excuse me', fr: 'Excusez-moi', es: 'Disculpe', de: 'Entschuldigung' },
      'Ø£Ø³Ù': { en: 'Sorry', fr: 'DÃ©solÃ©', es: 'Lo siento', de: 'Entschuldigung' },
      
      'Ù†Ø¹Ù…': { en: 'Yes', fr: 'Oui', es: 'SÃ­', de: 'Ja' },
      'Ù„Ø§': { en: 'No', fr: 'Non', es: 'No', de: 'Nein' },
      'Ø±Ø¨Ù…Ø§': { en: 'Maybe', fr: 'Peut-Ãªtre', es: 'QuizÃ¡s', de: 'Vielleicht' },
      
      'Ø£ÙŠÙ†': { en: 'Where', fr: 'OÃ¹', es: 'DÃ³nde', de: 'Wo' },
      'Ù…ØªÙ‰': { en: 'When', fr: 'Quand', es: 'CuÃ¡ndo', de: 'Wann' },
      'ÙƒÙŠÙ': { en: 'How', fr: 'Comment', es: 'CÃ³mo', de: 'Wie' },
      'Ù„Ù…Ø§Ø°Ø§': { en: 'Why', fr: 'Pourquoi', es: 'Por quÃ©', de: 'Warum' },
      
      'Ø£ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰': { en: 'Where is the hospital', fr: 'OÃ¹ est l\'hÃ´pital', es: 'Â¿DÃ³nde estÃ¡ el hospital?', de: 'Wo ist das Krankenhaus?' },
      'Ø£ÙŠÙ† Ø§Ù„Ø­Ù…Ø§Ù…': { en: 'Where is the bathroom', fr: 'OÃ¹ sont les toilettes', es: 'Â¿DÃ³nde estÃ¡ el baÃ±o?', de: 'Wo ist die Toilette?' },
      'Ø£ÙŠÙ† Ø§Ù„ÙÙ†Ø¯Ù‚': { en: 'Where is the hotel', fr: 'OÃ¹ est l\'hÃ´tel', es: 'Â¿DÃ³nde estÃ¡ el hotel?', de: 'Wo ist das Hotel?' },
      'Ø£ÙŠÙ† Ø§Ù„Ù…Ø·Ø§Ø±': { en: 'Where is the airport', fr: 'OÃ¹ est l\'aÃ©roport', es: 'Â¿DÃ³nde estÃ¡ el aeropuerto?', de: 'Wo ist der Flughafen?' },
      
      'Ø£Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©': { en: 'I need help', fr: 'J\'ai besoin d\'aide', es: 'Necesito ayuda', de: 'Ich brauche Hilfe' },
      'Ø³Ø§Ø¹Ø¯Ù†ÙŠ': { en: 'Help me', fr: 'Aidez-moi', es: 'AyÃºdame', de: 'Hilf mir' },
      
      'Ø£Ø±ÙŠØ¯ Ù…Ø§Ø¡': { en: 'I want water', fr: 'Je veux de l\'eau', es: 'Quiero agua', de: 'Ich mÃ¶chte Wasser' },
      'Ø£Ø±ÙŠØ¯ Ø·Ø¹Ø§Ù…': { en: 'I want food', fr: 'Je veux de la nourriture', es: 'Quiero comida', de: 'Ich mÃ¶chte Essen' },
      'Ø£Ù†Ø§ Ø¬Ø§Ø¦Ø¹': { en: 'I am hungry', fr: 'J\'ai faim', es: 'Tengo hambre', de: 'Ich habe Hunger' },
      'Ø£Ù†Ø§ Ø¹Ø·Ø´Ø§Ù†': { en: 'I am thirsty', fr: 'J\'ai soif', es: 'Tengo sed', de: 'Ich habe Durst' },
      
      'ÙƒÙ… Ø§Ù„Ø³Ø§Ø¹Ø©': { en: 'What time is it', fr: 'Quelle heure est-il', es: 'Â¿QuÃ© hora es?', de: 'Wie spÃ¤t ist es?' },
      'ÙƒÙ… Ø§Ù„Ø«Ù…Ù†': { en: 'How much does it cost', fr: 'Combien Ã§a coÃ»te', es: 'Â¿CuÃ¡nto cuesta?', de: 'Wie viel kostet es?' },
      
      'Ù„Ø§ Ø£ÙÙ‡Ù…': { en: 'I don\'t understand', fr: 'Je ne comprends pas', es: 'No entiendo', de: 'Ich verstehe nicht' },
      'ØªÙƒÙ„Ù… Ø¨Ø¨Ø·Ø¡': { en: 'Speak slowly', fr: 'Parlez lentement', es: 'Habla despacio', de: 'Sprich langsam' },
      'Ø£Ø¹Ø¯ Ù…Ù† ÙØ¶Ù„Ùƒ': { en: 'Repeat please', fr: 'RÃ©pÃ©tez s\'il vous plaÃ®t', es: 'Repite por favor', de: 'Wiederholen Sie bitte' },
      
      'Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰': { en: 'Hospital', fr: 'HÃ´pital', es: 'Hospital', de: 'Krankenhaus' },
      'Ø§Ù„Ø·Ø¨ÙŠØ¨': { en: 'Doctor', fr: 'Docteur', es: 'Doctor', de: 'Arzt' },
      'Ø§Ù„Ø¯ÙˆØ§Ø¡': { en: 'Medicine', fr: 'MÃ©dicament', es: 'Medicina', de: 'Medizin' }
    };

    let targetLanguage = 'en';
    let recognition = null;

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    document.addEventListener('DOMContentLoaded', function() {
      initLanguageButtons();
      initSpeechRecognition();
      setupMicButton();
    });

    // ØªÙ‡ÙŠØ¦Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„ØºØ§Øª
    function initLanguageButtons() {
      const langGrid = document.getElementById('languageGrid');
      
      languages.forEach(lang => {
        const button = document.createElement('button');
        button.className = 'lang-btn' + (lang.code === 'en' ? ' active' : '');
        button.innerHTML = `
          <div class="lang-flag">${lang.flag}</div>
          <div class="lang-name">${lang.name}</div>
        `;
        
        button.onclick = function() {
          document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          targetLanguage = lang.code;
          updateStatus(`Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¥Ù„Ù‰: ${lang.name}`);
        };
        
        langGrid.appendChild(button);
      });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª
    function initSpeechRecognition() {
      if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.lang = 'ar-SA'; // Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
        recognition.continuous = false;
        recognition.interimResults = false;
        
        recognition.onstart = function() {
          document.getElementById('micButton').classList.add('listening');
          updateStatus('ğŸ¤ ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ ÙƒÙ„Ø§Ù…Ùƒ...');
        };
        
        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript;
          console.log('ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰:', transcript);
          processSpeech(transcript);
        };
        
        recognition.onerror = function(event) {
          if (event.error === 'no-speech') {
            showError('Ù„Ù… Ø£Ø³Ù…Ø¹ Ø£ÙŠ ÙƒÙ„Ø§Ù…. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
          } else if (event.error === 'audio-capture') {
            showError('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†');
          } else if (event.error === 'not-allowed') {
            showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†');
          }
          stopListening();
        };
        
        recognition.onend = function() {
          stopListening();
        };
      } else {
        showError('Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Chrome Ø£Ùˆ Edge');
      }
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø²Ø± Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†
    function setupMicButton() {
      const micButton = document.getElementById('micButton');
      
      micButton.onclick = function() {
        if (recognition && recognition.recording) {
          recognition.stop();
        } else {
          startListening();
        }
      };
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
    function startListening() {
      try {
        clearTranslationArea();
        hideError();
        recognition.start();
      } catch (error) {
        showError('Ø®Ø·Ø£ ÙÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª');
      }
    }

    // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
    function stopListening() {
      document.getElementById('micButton').classList.remove('listening');
      updateStatus('Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ­Ø¯Ø« Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©');
    }

    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    function updateStatus(message) {
      document.getElementById('micStatus').textContent = message;
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒÙ„Ø§Ù…
    function processSpeech(text) {
      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ
      const cleanText = text.trim();
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØ±Ø¬Ù…Ø©
      let translatedText = '';
      
      if (translations[cleanText]) {
        translatedText = translations[cleanText][targetLanguage] || translations[cleanText]['en'];
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØªØ±Ø¬Ù…Ø© Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ù†Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„Ù…Ø§Øª Ù…Ø´Ø§Ø¨Ù‡Ø©
        for (const [arabicPhrase, translationsObj] of Object.entries(translations)) {
          if (cleanText.includes(arabicPhrase)) {
            translatedText = translationsObj[targetLanguage] || translationsObj['en'];
            break;
          }
        }
      }
      
      // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ ØªØ±Ø¬Ù…Ø©
      if (!translatedText) {
        translatedText = `[${getLanguageName(targetLanguage)}]: "${cleanText}"`;
      }
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      showResults(cleanText, translatedText);
      
      // Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
      speakTranslation(translatedText);
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù„ØºØ©
    function getLanguageName(code) {
      const lang = languages.find(l => l.code === code);
      return lang ? lang.name : 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©';
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    function showResults(original, translated) {
      const area = document.getElementById('translationArea');
      const targetLang = languages.find(l => l.code === targetLanguage);
      
      area.innerHTML = `
        <div class="result-box">
          <div class="result-header">
            <div class="result-lang">
              <span>ğŸ‡¸ğŸ‡¦</span>
              <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
            </div>
          </div>
          <div class="result-text">${original}</div>
        </div>
        
        <div class="result-box">
          <div class="result-header">
            <div class="result-lang">
              <span>${targetLang ? targetLang.flag : 'ğŸŒ'}</span>
              <span>${targetLang ? targetLang.name : 'Ø§Ù„ØªØ±Ø¬Ù…Ø©'}</span>
            </div>
          </div>
          <div class="result-text" style="font-weight: bold;">${translated}</div>
          
          <div class="action-buttons">
            <button class="action-btn speak" onclick="speakTranslation('${escapeText(translated)}')">
              <i class="fas fa-volume-up"></i>
              Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
            </button>
            <button class="action-btn copy" onclick="copyToClipboard('${escapeText(translated)}')">
              <i class="far fa-copy"></i>
              Ù†Ø³Ø® Ø§Ù„Ù†Øµ
            </button>
          </div>
        </div>
      `;
    }

    // Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø©
    function speakTranslation(text) {
      if ('speechSynthesis' in window) {
        const speech = new SpeechSynthesisUtterance(text);
        const targetLang = languages.find(l => l.code === targetLanguage);
        
        if (targetLang) {
          speech.lang = targetLang.voice;
          speech.rate = 0.9;
          speech.pitch = 1;
          speech.volume = 1;
          
          window.speechSynthesis.speak(speech);
        }
      }
    }

    // Ù†Ø³Ø® Ø§Ù„Ù†Øµ
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ');
      });
    }

    // Ù…Ø³Ø­ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©
    function clearTranslationArea() {
      const area = document.getElementById('translationArea');
      area.innerHTML = '';
    }

    // Ø¥Ø¸Ù‡Ø§Ø± Ø®Ø·Ø£
    function showError(message) {
      const errorBox = document.getElementById('errorBox');
      const errorText = document.getElementById('errorText');
      
      errorText.textContent = message;
      errorBox.classList.remove('hidden');
      
      setTimeout(() => {
        errorBox.classList.add('hidden');
      }, 5000);
    }

    // Ø¥Ø®ÙØ§Ø¡ Ø®Ø·Ø£
    function hideError() {
      document.getElementById('errorBox').classList.add('hidden');
    }

    // ØªÙ‡Ø±ÙŠØ¨ Ø§Ù„Ù†Øµ
    function escapeText(text) {
      return text.replace(/'/g, "\\'").replace(/"/g, '\\"');
    }
  </script>
</body>
</html>